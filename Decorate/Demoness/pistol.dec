ACTOR Hexen2BloodFire : Weapon
{
  Weapon.SelectionOrder 1400
  Weapon.Kickback 100
  Weapon.SlotNumber 1
  Weapon.BobRangeX 0
  Weapon.BobRangeY 0.75
  Weapon.BobSpeed 1.4
  Weapon.BobStyle Alpha   
  +WEAPON.WIMPY_WEAPON
  +WEAPON.NOALERT
  States
  {
	Spawn:
	  HX00 A -1
	  Stop
	Ready:
	  HX00 A 0 A_JumpIfInventory("PowerWeaponLevel2",1,"ReadyPowered")
	  HX03 ABCDEFGHIJKLMNOPQRST 2
	  Goto WeaponIdle
	WeaponIdle:
	  HX01 A 2 A_WeaponReady		HX01 B 0 A_JumpIfInventory("PowerWeaponLevel2",1,"WeaponIdlePowered")
	  HX01 B 2 A_WeaponReady		HX01 C 0 A_JumpIfInventory("PowerWeaponLevel2",1,"WeaponIdlePowered")
	  HX01 C 2 A_WeaponReady		HX01 D 0 A_JumpIfInventory("PowerWeaponLevel2",1,"WeaponIdlePowered")
	  HX01 D 2 A_WeaponReady		HX01 E 0 A_JumpIfInventory("PowerWeaponLevel2",1,"WeaponIdlePowered")
	  HX01 E 2 A_WeaponReady		HX01 F 0 A_JumpIfInventory("PowerWeaponLevel2",1,"WeaponIdlePowered")
	  HX01 F 2 A_WeaponReady		HX01 G 0 A_JumpIfInventory("PowerWeaponLevel2",1,"WeaponIdlePowered")
	  HX01 G 2 A_WeaponReady		HX01 H 0 A_JumpIfInventory("PowerWeaponLevel2",1,"WeaponIdlePowered")
	  HX01 H 2 A_WeaponReady		HX01 I 0 A_JumpIfInventory("PowerWeaponLevel2",1,"WeaponIdlePowered")
	  HX01 I 2 A_WeaponReady		HX01 J 0 A_JumpIfInventory("PowerWeaponLevel2",1,"WeaponIdlePowered")
	  HX01 J 2 A_WeaponReady		HX01 K 0 A_JumpIfInventory("PowerWeaponLevel2",1,"WeaponIdlePowered")
	  HX01 K 2 A_WeaponReady		HX01 L 0 A_JumpIfInventory("PowerWeaponLevel2",1,"WeaponIdlePowered")
	  HX01 L 2 A_WeaponReady		HX01 M 0 A_JumpIfInventory("PowerWeaponLevel2",1,"WeaponIdlePowered")
	  HX01 M 2 A_WeaponReady		HX01 N 0 A_JumpIfInventory("PowerWeaponLevel2",1,"WeaponIdlePowered")
	  HX01 N 2 A_WeaponReady		HX01 O 0 A_JumpIfInventory("PowerWeaponLevel2",1,"WeaponIdlePowered")
	  HX01 O 2 A_WeaponReady		HX01 P 0 A_JumpIfInventory("PowerWeaponLevel2",1,"WeaponIdlePowered")
	  HX01 P 2 A_WeaponReady		HX01 Q 0 A_JumpIfInventory("PowerWeaponLevel2",1,"WeaponIdlePowered")
	  HX01 Q 2 A_WeaponReady		HX01 R 0 A_JumpIfInventory("PowerWeaponLevel2",1,"WeaponIdlePowered")
	  HX01 R 2 A_WeaponReady		HX01 S 0 A_JumpIfInventory("PowerWeaponLevel2",1,"WeaponIdlePowered")
	  HX01 S 2 A_WeaponReady		HX01 T 0 A_JumpIfInventory("PowerWeaponLevel2",1,"WeaponIdlePowered")
	  HX01 T 2 A_WeaponReady		HX01 U 0 A_JumpIfInventory("PowerWeaponLevel2",1,"WeaponIdlePowered")
	  HX01 U 2 A_WeaponReady		HX01 V 0 A_JumpIfInventory("PowerWeaponLevel2",1,"WeaponIdlePowered")
	  HX01 V 2 A_WeaponReady		HX01 W 0 A_JumpIfInventory("PowerWeaponLevel2",1,"WeaponIdlePowered")
	  HX01 W 2 A_WeaponReady		HX01 X 0 A_JumpIfInventory("PowerWeaponLevel2",1,"WeaponIdlePowered")
	  HX01 X 2 A_WeaponReady		HX01 A 0 A_JumpIfInventory("PowerWeaponLevel2",1,"WeaponIdlePowered")
	  HX01 A 0 A_JumpIf(random(1,10) == 1, "WeaponIdleJellyFingers")
      Loop
	WeaponIdleJellyFingers:
	  HX02 A 2 A_WeaponReady		HX02 B 0 A_JumpIfInventory("PowerWeaponLevel2",1,"WeaponIdlePowered")
	  HX02 B 2 A_WeaponReady		HX02 C 0 A_JumpIfInventory("PowerWeaponLevel2",1,"WeaponIdlePowered")
	  HX02 C 2 A_WeaponReady		HX02 D 0 A_JumpIfInventory("PowerWeaponLevel2",1,"WeaponIdlePowered")
	  HX02 D 2 A_WeaponReady		HX02 E 0 A_JumpIfInventory("PowerWeaponLevel2",1,"WeaponIdlePowered")
	  HX02 E 2 A_WeaponReady		HX02 F 0 A_JumpIfInventory("PowerWeaponLevel2",1,"WeaponIdlePowered")
	  HX02 F 2 A_WeaponReady		HX02 G 0 A_JumpIfInventory("PowerWeaponLevel2",1,"WeaponIdlePowered")
	  HX02 G 2 A_WeaponReady		HX02 H 0 A_JumpIfInventory("PowerWeaponLevel2",1,"WeaponIdlePowered")
	  HX02 H 2 A_WeaponReady		HX02 I 0 A_JumpIfInventory("PowerWeaponLevel2",1,"WeaponIdlePowered")
	  HX02 I 2 A_WeaponReady		HX02 J 0 A_JumpIfInventory("PowerWeaponLevel2",1,"WeaponIdlePowered")
	  HX02 J 2 A_WeaponReady		HX02 K 0 A_JumpIfInventory("PowerWeaponLevel2",1,"WeaponIdlePowered")
	  HX02 K 2 A_WeaponReady		HX02 L 0 A_JumpIfInventory("PowerWeaponLevel2",1,"WeaponIdlePowered")
	  HX02 L 2 A_WeaponReady		HX02 M 0 A_JumpIfInventory("PowerWeaponLevel2",1,"WeaponIdlePowered")
	  HX02 M 2 A_WeaponReady		HX02 N 0 A_JumpIfInventory("PowerWeaponLevel2",1,"WeaponIdlePowered")
	  HX02 N 2 A_WeaponReady		HX02 O 0 A_JumpIfInventory("PowerWeaponLevel2",1,"WeaponIdlePowered")
	  HX02 O 2 A_WeaponReady		HX02 P 0 A_JumpIfInventory("PowerWeaponLevel2",1,"WeaponIdlePowered")
	  HX02 P 2 A_WeaponReady		HX02 Q 0 A_JumpIfInventory("PowerWeaponLevel2",1,"WeaponIdlePowered")
	  HX02 Q 2 A_WeaponReady		HX02 R 0 A_JumpIfInventory("PowerWeaponLevel2",1,"WeaponIdlePowered")
	  HX02 R 2 A_WeaponReady		HX02 S 0 A_JumpIfInventory("PowerWeaponLevel2",1,"WeaponIdlePowered")
	  HX02 S 2 A_WeaponReady		HX02 T 0 A_JumpIfInventory("PowerWeaponLevel2",1,"WeaponIdlePowered")
	  HX02 T 2 A_WeaponReady		HX02 U 0 A_JumpIfInventory("PowerWeaponLevel2",1,"WeaponIdlePowered")
	  HX02 U 2 A_WeaponReady		HX02 V 0 A_JumpIfInventory("PowerWeaponLevel2",1,"WeaponIdlePowered")
	  HX02 V 2 A_WeaponReady		HX02 W 0 A_JumpIfInventory("PowerWeaponLevel2",1,"WeaponIdlePowered")
	  HX02 W 2 A_WeaponReady		HX02 X 0 A_JumpIfInventory("PowerWeaponLevel2",1,"WeaponIdlePowered")
	  HX02 X 2 A_WeaponReady		HX02 A 0 A_JumpIfInventory("PowerWeaponLevel2",1,"WeaponIdlePowered")
	  Goto WeaponIdle
	ReadyPowered:
	  HX03 ABCDEFGHIJKLMNOPQRST 2 Bright
	  Goto WeaponIdlePowered
	WeaponIdlePowered:
	  HX01 A 2 Bright A_WeaponReady		HX01 B 0 A_JumpIfInventory("PowerWeaponLevel2",1,1)		Goto WeaponIdle
	  HX01 B 2 Bright A_WeaponReady		HX01 C 0 A_JumpIfInventory("PowerWeaponLevel2",1,1)		Goto WeaponIdle
	  HX01 C 2 Bright A_WeaponReady		HX01 D 0 A_JumpIfInventory("PowerWeaponLevel2",1,1)		Goto WeaponIdle
	  HX01 D 2 Bright A_WeaponReady		HX01 E 0 A_JumpIfInventory("PowerWeaponLevel2",1,1)		Goto WeaponIdle
	  HX01 E 2 Bright A_WeaponReady		HX01 F 0 A_JumpIfInventory("PowerWeaponLevel2",1,1)		Goto WeaponIdle
	  HX01 F 2 Bright A_WeaponReady		HX01 G 0 A_JumpIfInventory("PowerWeaponLevel2",1,1)		Goto WeaponIdle
	  HX01 G 2 Bright A_WeaponReady		HX01 H 0 A_JumpIfInventory("PowerWeaponLevel2",1,1)		Goto WeaponIdle
	  HX01 H 2 Bright A_WeaponReady		HX01 I 0 A_JumpIfInventory("PowerWeaponLevel2",1,1)		Goto WeaponIdle
	  HX01 I 2 Bright A_WeaponReady		HX01 J 0 A_JumpIfInventory("PowerWeaponLevel2",1,1)		Goto WeaponIdle
	  HX01 J 2 Bright A_WeaponReady		HX01 K 0 A_JumpIfInventory("PowerWeaponLevel2",1,1)		Goto WeaponIdle
	  HX01 K 2 Bright A_WeaponReady		HX01 L 0 A_JumpIfInventory("PowerWeaponLevel2",1,1)		Goto WeaponIdle
	  HX01 L 2 Bright A_WeaponReady		HX01 M 0 A_JumpIfInventory("PowerWeaponLevel2",1,1)		Goto WeaponIdle
	  HX01 M 2 Bright A_WeaponReady		HX01 N 0 A_JumpIfInventory("PowerWeaponLevel2",1,1)		Goto WeaponIdle
	  HX01 N 2 Bright A_WeaponReady		HX01 O 0 A_JumpIfInventory("PowerWeaponLevel2",1,1)		Goto WeaponIdle
	  HX01 O 2 Bright A_WeaponReady		HX01 P 0 A_JumpIfInventory("PowerWeaponLevel2",1,1)		Goto WeaponIdle
	  HX01 P 2 Bright A_WeaponReady		HX01 Q 0 A_JumpIfInventory("PowerWeaponLevel2",1,1)		Goto WeaponIdle
	  HX01 Q 2 Bright A_WeaponReady		HX01 R 0 A_JumpIfInventory("PowerWeaponLevel2",1,1)		Goto WeaponIdle
	  HX01 R 2 Bright A_WeaponReady		HX01 S 0 A_JumpIfInventory("PowerWeaponLevel2",1,1)		Goto WeaponIdle
	  HX01 S 2 Bright A_WeaponReady		HX01 T 0 A_JumpIfInventory("PowerWeaponLevel2",1,1)		Goto WeaponIdle
	  HX01 T 2 Bright A_WeaponReady		HX01 U 0 A_JumpIfInventory("PowerWeaponLevel2",1,1)		Goto WeaponIdle
	  HX01 U 2 Bright A_WeaponReady		HX01 V 0 A_JumpIfInventory("PowerWeaponLevel2",1,1)		Goto WeaponIdle
	  HX01 V 2 Bright A_WeaponReady		HX01 W 0 A_JumpIfInventory("PowerWeaponLevel2",1,1)		Goto WeaponIdle
	  HX01 W 2 Bright A_WeaponReady		HX01 X 0 A_JumpIfInventory("PowerWeaponLevel2",1,1)		Goto WeaponIdle
	  HX01 X 2 Bright A_WeaponReady		HX01 A 0 A_JumpIfInventory("PowerWeaponLevel2",1,1)		Goto WeaponIdle
	  HX01 A 0 A_JumpIf(random(1,10) == 1, "WeaponIdleJellyFingers")
      Loop
	WeaponIdleJellyFingersPowered:
	  HX02 A 2 Bright A_WeaponReady		HX02 B 0 A_JumpIfInventory("PowerWeaponLevel2",1,1)		Goto WeaponIdle
	  HX02 B 2 Bright A_WeaponReady		HX02 C 0 A_JumpIfInventory("PowerWeaponLevel2",1,1)		Goto WeaponIdle
	  HX02 C 2 Bright A_WeaponReady		HX02 D 0 A_JumpIfInventory("PowerWeaponLevel2",1,1)		Goto WeaponIdle
	  HX02 D 2 Bright A_WeaponReady		HX02 E 0 A_JumpIfInventory("PowerWeaponLevel2",1,1)		Goto WeaponIdle
	  HX02 E 2 Bright A_WeaponReady		HX02 F 0 A_JumpIfInventory("PowerWeaponLevel2",1,1)		Goto WeaponIdle
	  HX02 F 2 Bright A_WeaponReady		HX02 G 0 A_JumpIfInventory("PowerWeaponLevel2",1,1)		Goto WeaponIdle
	  HX02 G 2 Bright A_WeaponReady		HX02 H 0 A_JumpIfInventory("PowerWeaponLevel2",1,1)		Goto WeaponIdle
	  HX02 H 2 Bright A_WeaponReady		HX02 I 0 A_JumpIfInventory("PowerWeaponLevel2",1,1)		Goto WeaponIdle
	  HX02 I 2 Bright A_WeaponReady		HX02 J 0 A_JumpIfInventory("PowerWeaponLevel2",1,1)		Goto WeaponIdle
	  HX02 J 2 Bright A_WeaponReady		HX02 K 0 A_JumpIfInventory("PowerWeaponLevel2",1,1)		Goto WeaponIdle
	  HX02 K 2 Bright A_WeaponReady		HX02 L 0 A_JumpIfInventory("PowerWeaponLevel2",1,1)		Goto WeaponIdle
	  HX02 L 2 Bright A_WeaponReady		HX02 M 0 A_JumpIfInventory("PowerWeaponLevel2",1,1)		Goto WeaponIdle
	  HX02 M 2 Bright A_WeaponReady		HX02 N 0 A_JumpIfInventory("PowerWeaponLevel2",1,1)		Goto WeaponIdle
	  HX02 N 2 Bright A_WeaponReady		HX02 O 0 A_JumpIfInventory("PowerWeaponLevel2",1,1)		Goto WeaponIdle
	  HX02 O 2 Bright A_WeaponReady		HX02 P 0 A_JumpIfInventory("PowerWeaponLevel2",1,1)		Goto WeaponIdle
	  HX02 P 2 Bright A_WeaponReady		HX02 Q 0 A_JumpIfInventory("PowerWeaponLevel2",1,1)		Goto WeaponIdle
	  HX02 Q 2 Bright A_WeaponReady		HX02 R 0 A_JumpIfInventory("PowerWeaponLevel2",1,1)		Goto WeaponIdle
	  HX02 R 2 Bright A_WeaponReady		HX02 S 0 A_JumpIfInventory("PowerWeaponLevel2",1,1)		Goto WeaponIdle
	  HX02 S 2 Bright A_WeaponReady		HX02 T 0 A_JumpIfInventory("PowerWeaponLevel2",1,1)		Goto WeaponIdle
	  HX02 T 2 Bright A_WeaponReady		HX02 U 0 A_JumpIfInventory("PowerWeaponLevel2",1,1)		Goto WeaponIdle
	  HX02 U 2 Bright A_WeaponReady		HX02 V 0 A_JumpIfInventory("PowerWeaponLevel2",1,1)		Goto WeaponIdle
	  HX02 V 2 Bright A_WeaponReady		HX02 W 0 A_JumpIfInventory("PowerWeaponLevel2",1,1)		Goto WeaponIdle
	  HX02 W 2 Bright A_WeaponReady		HX02 X 0 A_JumpIfInventory("PowerWeaponLevel2",1,1)		Goto WeaponIdle
	  HX02 X 2 Bright A_WeaponReady		HX02 A 0 A_JumpIfInventory("PowerWeaponLevel2",1,"WeaponIdlePowered")
	  Goto WeaponIdlePowered
	Select:
	  TNT1 A 0 A_GiveInventory("Hexen2Weapon1",1)
	  TNT1 A 0 A_TakeInventory("Hexen2Weapon2",1)
	  TNT1 A 0 A_TakeInventory("Hexen2Weapon3",1)
	  TNT1 A 0 SetPlayerProperty(0,1,2)
	  TNT1 A 1 A_Raise
	  Wait
	Deselect:
	  TNT1 A 0 A_TakeInventory("Hexen2Weapon1",1)
	  HX00 A 0 A_JumpIfInventory("PowerWeaponLevel2",1,"DeselectPowered")
	  HX03 TSRQPONMLKJIHGFEDCBA 2
      TNT1 A 1 A_Lower
      Wait
	DeselectPowered:
	  HX03 TSRQPONMLKJIHGFEDCBA 2 Bright
      TNT1 A 1 A_Lower
      Wait
	Fire:
	  HX00 A 0 A_AlertMonsters
	  HX00 A 0 A_JumpIfInventory("PowerWeaponLevel2",1,"FirePowered")
      HX00 ACE 2
	  HX00 G 2 A_FireCustomMissile("Hexen2BloodFireProjectile",0,0,-8,4)
	  HX00 HJL 2
      Goto WeaponIdle
	FirePowered:
      HX00 ACEG 2 Bright
	  HX00 G 0 A_FireCustomMissile("Hexen2BloodFireProjectilePoweredLeft",-3,0,-8,4)
	  HX00 G 0 A_FireCustomMissile("Hexen2BloodFireProjectilePoweredCenter",0,0,-8,4)
	  HX00 G 0 A_FireCustomMissile("Hexen2BloodFireProjectilePoweredRight",3,0,-8,4)
	  HX00 HJL 2 Bright
      Goto WeaponIdlePowered
	NoFrames:
	  HX00 A 0 bright A_Stop HX01 A 0 bright A_Stop HX02 A 0 bright A_Stop HX03 A 0 bright A_Stop HX04 A 0 bright A_Stop HX05 A 0 bright A_Stop 
	  HX06 A 0 bright A_Stop HX07 A 0 bright A_Stop HX08 A 0 bright A_Stop HX09 A 0 bright A_Stop HX10 A 0 bright A_Stop HX11 A 0 bright A_Stop 
	  HX12 A 0 bright A_Stop HX13 A 0 bright A_Stop HX14 A 0 bright A_Stop HX15 A 0 bright A_Stop HX16 A 0 bright A_Stop HX17 A 0 bright A_Stop 
	  stop
  }
}

Actor Hexen2BloodFireTimer : Hexen2Counter { Inventory.MaxAmount 100 }
Actor Hexen2BloodFireRandomizer : Hexen2Boolean {}
Actor Hexen2BloodFireDamageTokens : Hexen2Counter { Inventory.MaxAmount 32 }

Actor Hexen2BloodFireProjectile
{
	Projectile
	Speed 13
	Damage (CallACS("Hexen2_IntelligenceMultiplier",CallACS("Hexen2_BloodFireDamageFallOff",(CallACS("Hexen2_Decorate",31)*0.1))))
	Radius 3
	Height 6
	Scale 1.3
	+BLOODLESSIMPACT
	DamageType "Hexen2Damage"
	States //for now the think time for predetonation projectile is 3 instead of 2, 2 is too pitiful here
	{
		Spawn:
		  HX00 A 0
		  HX00 A 0 A_PlaySound("Hexen2/BloodRuneFire", CHAN_WEAPON)
		  HX00 A 0 ACS_NamedExecuteAlways("Hexen2_BloodFireDamage",0,3,0)
		  HX00 ABCD 3 Bright
		SpawnLoop:
		  HX00 E 0 A_JumpIf(CallACS("Hexen2_Decorate",32) == 1,"Remove")
		  HX00 E 0 A_SetTranslucent(alpha-(0.15-(CallACS("Hexen2_Decorate",31)*0.003)))
		  HX00 E 0 A_SetScale(scalex-(0.15-(CallACS("Hexen2_Decorate",31)*0.003)))
		  HX00 E 3 Bright A_GiveInventory("Hexen2BloodFireTimer",1)
		  Loop
		Remove:
		  TNT1 A 1
		  stop
		Death:
		Crash:
		  TNT1 A 0 A_PlaySound("Hexen2/BloodRuneWall", CHAN_5)
		  TNT1 A 0 A_SetTranslucent(1.0)
		  TNT1 A 0 A_SetScale(1.0)
		  HX07 ABCDEFG 2 Bright
		  stop
		XDeath:
		  TNT1 A 0 A_PlaySound("Hexen2/BloodRuneHit", CHAN_5)
		  TNT1 A 0 A_SetTranslucent(1.0)
		  TNT1 A 0 A_SetScale(1.0)
		  HX07 ABCDEFG 2 Bright
		  stop
	}
}

Actor Hexen2BloodFireProjectilePoweredCenter : Hexen2BloodFireProjectile
{
	BounceType "Hexen"
	BounceSound "Hexen2/BloodRuneBounce"
	Scale 2
	Damage (CallACS("Hexen2_IntelligenceMultiplier",CallACS("Hexen2_BloodFireDamageFallOff",1+(CallACS("Hexen2_Decorate",31)*0.1))))
	+USEBOUNCESTATE
	States
	{
		Spawn:
		  HX00 A 0
		  HX00 A 0 A_PlaySound("Hexen2/BloodRuneFire", CHAN_WEAPON)
		  HX00 A 0 ACS_NamedExecuteAlways("Hexen2_BloodFireDamage",0,3,1)
		  HX00 ABCD 3 Bright
		SpawnLoop:
		  HX00 E 0 A_JumpIf(CallACS("Hexen2_Decorate",32) == 1,"Remove")
		  HX00 E 0 A_SetTranslucent(alpha-(0.04-(CallACS("Hexen2_Decorate",31)*0.0008)))
		  HX00 E 0 A_SetScale(scalex-(0.08-(CallACS("Hexen2_Decorate",31)*0.0016)))
		  HX00 E 3 Bright A_GiveInventory("Hexen2BloodFireTimer",1)
		  Loop
		Bounce:
		  HX00 A 0 A_SpawnItemEx("Hexen2BloodRuneBounceSpark")
		  Goto SpawnLoop
	}
}

Actor Hexen2BloodFireProjectilePoweredLeft : Hexen2BloodFireProjectilePoweredCenter
{
	States
	{
		Spawn:
		  HX00 A 0
		  HX00 A 0 A_PlaySound("Hexen2/BloodRuneFire", CHAN_WEAPON)
		  HX00 A 0 ACS_NamedExecuteAlways("Hexen2_BloodFireDamage",0,3,1)
		  HX00 ABCD 3 Bright
		  HX00 A 0 ACS_NamedExecuteAlways("Hexen2_AngleInterpolate",0,angle,angle+3,1)
		  HX00 A 0 A_ChangeVelocity(13,0,velz,CVF_RELATIVE|CVF_REPLACE)
		  Goto SpawnLoop
	}
}

Actor Hexen2BloodFireProjectilePoweredRight : Hexen2BloodFireProjectilePoweredCenter
{
	States
	{
		Spawn:
		  HX00 A 0
		  HX00 A 0 A_PlaySound("Hexen2/BloodRuneFire", CHAN_WEAPON)
		  HX00 A 0 ACS_NamedExecuteAlways("Hexen2_BloodFireDamage",0,3,1)
		  HX00 ABCD 3 Bright
		  HX00 A 0 ACS_NamedExecuteAlways("Hexen2_AngleInterpolate",0,angle,angle-3,1)
		  HX00 A 0 A_ChangeVelocity(13,0,velz,CVF_RELATIVE|CVF_REPLACE)
		  Goto SpawnLoop
	}
}

Actor Hexen2BloodRuneBounceSpark : Hexen2WhiteSmoke
{
	Alpha 1.0
	States
	{
		Spawn:
			TNT1 A 0
			HX23 ABCDEFGHI 2 Bright
			stop
	}
}
