Actor Goldeneye_UnarmedToken : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 1 Inventory.InterHubAmount 0 }
Actor Goldeneye_PP7Token : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 1 Inventory.InterHubAmount 0 }
Actor Goldeneye_KnifeToken : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 1 Inventory.InterHubAmount 0 }
Actor Goldeneye_KF7Token : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 1 Inventory.InterHubAmount 0 }
Actor Goldeneye_AutoShotgunToken : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 1 Inventory.InterHubAmount 0 }
Actor Goldeneye_AR33Token : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 1 Inventory.InterHubAmount 0 }
Actor Goldeneye_PhantomToken : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 1 Inventory.InterHubAmount 0 }
Actor Goldeneye_RocketLauncherToken : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 1 Inventory.InterHubAmount 0 }
Actor Goldeneye_GrenadeLauncherToken : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 1 Inventory.InterHubAmount 0 }
Actor Goldeneye_RCP90Token : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 1 Inventory.InterHubAmount 0 }
Actor Goldeneye_CougarToken : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 1 Inventory.InterHubAmount 0 }
Actor Goldeneye_LaserToken : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 1 Inventory.InterHubAmount 0 }
Actor Goldeneye_GoldenGunToken : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 1 Inventory.InterHubAmount 0 }
Actor Goldeneye_SniperToken : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 1 Inventory.InterHubAmount 0 }
Actor Goldeneye_D5KToken : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 1 Inventory.InterHubAmount 0 }
Actor Goldeneye_GoldPP7Token : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 1 Inventory.InterHubAmount 0 }
Actor Goldeneye_PP7DualToken : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 1 }
Actor Goldeneye_ThrowingKnivesDualToken : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 1 }
Actor Goldeneye_KF7DualToken : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 1 }
Actor Goldeneye_AutoShotgunDualToken : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 1 }
Actor Goldeneye_AR33DualToken : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 1 }
Actor Goldeneye_PhantomDualToken : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 1 }
Actor Goldeneye_RocketLauncherDualToken : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 1 }
Actor Goldeneye_GrenadeLauncherDualToken : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 1 }
Actor Goldeneye_RCP90DualToken : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 1 }
Actor Goldeneye_CougarDualToken : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 1 }
Actor Goldeneye_LaserDualToken : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 1 }
Actor Goldeneye_GoldenGunDualToken : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 1 }
Actor Goldeneye_SniperDualToken : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 1 }
Actor Goldeneye_D5KDualToken : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 1 }
Actor Goldeneye_GoldPP7DualToken : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 1 }

Actor BondClass : Inventory { -INVBAR +INVENTORY.UNDROPPABLE Inventory.MaxAmount 1 }
Actor BondMusicToken : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 52 }
Actor BondGunAngle : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 10 }
Actor BondGunAngleFiringSingle : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 10 }
Actor BondGunAngleFiringDual : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 10 }
Actor BondFiringToken : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 1 }
Actor BondWatchToken : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 1 }
Actor BondWatchQueue : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 1 }
Actor BondWatchUIInit : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 1 }
Actor BondWatchAnimation : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 1 }
Actor BondWatchTabSwitch : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 1 }
Actor BondWatchUIDeinit : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 1 }
Actor BondWatchActivate : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 1 }
Actor BondZoomToken : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 1 }
Actor BondZoomAmount : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 20 }
Actor BondZoomAmountModifyActive : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 1 }
Actor BondAltToggle : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 2 }
Actor BondPitchTokens : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 32768 }
Actor BondAngleTokens : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 131072 }
Actor BondWeaponToken : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 30 }
Actor BondWeaponSwitchToken : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 30 }
Actor BondAltActivationToken : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 1 }
Actor BondDualWieldToken : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 1 }
Actor BondDualWieldSpamProtector : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 1 }
Actor BondHoldingToken : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 1 }
Actor BondAlternateFire : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 1 }
Actor BondFireDelay : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 3 }
Actor BondDryFireSpamProtector1 : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 1 }
Actor BondDryFireSpamProtector2 : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 1 }
Actor BondDualReloadSpamProtector : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 1 }
Actor BondRocketLifeTime : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 11 }
Actor BondInstantSwitch : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 1 }
Actor BondTimedMineTimer : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 70 }
Actor BondWatchDetonatorToken : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 1 }
Actor BondPrimaryToken : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 1 }
Actor BondSecondaryToken : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 1 }
Actor BondWeapons : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 12 }
Actor BondDualiesToken : Inventory { -INVENTORY.INVBAR Inventory.MaxAmount 10 }
actor SamsaraGoldenEyeUnzoomedBurstSingleAttackAmount : Counter {}
actor SamsaraGoldenEyeUnzoomedBurstDualAttackAmount : Counter {}
Actor BondAccuracyX : TemporaryCounter {}
Actor BondAccuracyY : TemporaryCounter {}

actor Goldeneye_BulletTracer : FastProjectile
{
    var int user_damage;
    Projectile
    Radius 2
    Height 4
    Speed 96
    Damage (0)
    DamageType "GEBullet"
    RenderStyle "Add"
    Alpha 0.5
    Decal "Goldeneye_BulletChip"
    +DONTBLAST
    +FORCERADIUSDMG
    +HITTRACER
    +NODAMAGETHRUST
    +NOEXTREMEDEATH
    +NOTIMEFREEZE
    States
    {
      Spawn:
		TNT1 A 0
		TNT1 A 1
        GE00 A -1 Bright A_ChangeVelocity(velx*2,vely*2,velz*2,CVF_REPLACE)
        stop

      Death:
        TNT1 A 0 A_PlaySound("Goldeneye/Ricochet")
      DeathFinish:
        TNT1 AAAAAAAA 0 A_SpawnItemEx("Goldeneye_Debris",random(-1,1),random(-1,1),random(-1,1),random(-1,1),random(-1,1),random(-1,1),random(-360,360),SXF_NOCHECKPOSITION)
        TNT1 A 1 A_SpawnItemEx("Goldeneye_BulletImpact",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
        stop

      XDeath:
        TNT1 A 0 A_Explode(CallACS("BondHitBox", user_damage),8,0,false,8)
        TNT1 A 0 ACS_NamedExecuteWithResult("SamsaraBloodGeneratorOffsets")
        TNT1 A 0 A_GiveInventory("GE_BloodGenerator",1,AAPTR_TRACER)
        TNT1 A 1 A_RearrangePointers(AAPTR_TRACER,AAPTR_NULL,AAPTR_NULL)
        stop

      Crash:
        TNT1 A 0 A_PlaySound("Goldeneye/Ricochet")
		TNT1 A 0 A_Explode(CallACS("BondHitBox", user_damage),8,0,false,8)
      CrashFinish:
        TNT1 AAAAAAAA 0 A_SpawnItemEx("Goldeneye_Debris",random(-1,1),random(-1,1),random(-1,1),random(-1,1),random(-1,1),random(-1,1),random(-360,360),SXF_NOCHECKPOSITION)
        TNT1 A 1 A_SpawnItemEx("Goldeneye_BulletImpact_Smokeless",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
        stop
    }
}

actor Goldeneye_BulletTracerThruGhost : Goldeneye_BulletTracer { +THRUGHOST }

actor Goldeneye_BulletTracerSoundSource : Goldeneye_BulletTracer
{
    States
    {
      Death:
        TNT1 A 0 A_PlaySound("GoldeneyeSource/Ricochet")
        goto DeathFinish

      Crash:
        TNT1 A 0 A_PlaySound("GoldeneyeSource/Ricochet")
		TNT1 A 0 A_Explode(CallACS("BondHitBox", user_damage),8,0,false,8)
        goto CrashFinish
    }
}

actor Goldeneye_BulletTracerThruGhostSoundSource : Goldeneye_BulletTracerSoundSource { +THRUGHOST }

Actor Goldeneye_BulletImpact
{
	+NOINTERACTION
	Height 4
	Radius 2
	Scale 0.25
	States
	{
		Spawn:
			TNT1 A 0
			TNT1 A 0 A_Jump(256, "Spawn1", "Spawn2", "Spawn3", "Spawn4")
			Goto Spawn1
		Spawn1:
			GE00 ABCDE 2 Bright
			Goto SpawnEnd
		Spawn2:
			GE01 ABCDE 2 Bright
			Goto SpawnEnd
		Spawn3:
			GE02 ABCDE 2 Bright
			Goto SpawnEnd
		Spawn4:
			GE03 ABCDE 2 Bright
			Goto SpawnEnd
		SpawnEnd:
			TNT1 A 10
			TNT1 A 10 A_SpawnItemEx("Goldeneye_BulletSmoke", 0, 0, 0, 0, 0, 0, 0, SXF_NOCHECKPOSITION|SXF_CLIENTSIDE)
			TNT1 A 0 A_SpawnItemEx("Goldeneye_BulletSmoke", 0, 0, 0, 0, 0, 0, 0, SXF_NOCHECKPOSITION|SXF_CLIENTSIDE)
			stop
	}
}

Actor Goldeneye_BulletImpact_Smokeless : Goldeneye_BulletImpact
{
	States
	{
		Spawn:
			TNT1 A 0
			TNT1 A 0 A_Jump(256, "Spawn1", "Spawn2", "Spawn3", "Spawn4")
			Goto Spawn1
		Spawn1:
			GE00 ABCDE 2 Bright
			stop
		Spawn2:
			GE01 ABCDE 2 Bright
			stop
		Spawn3:
			GE02 ABCDE 2 Bright
			stop
		Spawn4:
			GE03 ABCDE 2 Bright
			stop
	}
}

actor Goldeneye_BulletPuff
{
    var int user_damage;
    Radius 2
    Height 4
    Speed 0
    Damage (0)
    DamageType "GEBullet"
    RenderStyle "Add"
    Alpha 0.5
    +DONTBLAST
    +FORCERADIUSDMG
    +HITTRACER
    +NODAMAGETHRUST
    +NOEXTREMEDEATH
    +NOTIMEFREEZE
	+ALWAYSPUFF
	+THRUACTORS
	+PUFFGETSOWNER
	-SOLID
	+BLOODLESSIMPACT
	-BLOODSPLATTER
	+DONTSPLASH
    States
    {
      Spawn:
		TNT1 A 1 NoDelay A_Explode(CallACS("BondHitBox", user_damage),8,0,false,8)
	  Death:
	  Crash:
      XDeath:
	  DeathFinish:
        TNT1 A 1
        stop

      XDeath:
		TNT1 A 0 ACS_NamedExecuteWithResult("SamsaraBloodGeneratorOffsets")
        TNT1 A 0 A_GiveInventory("GE_BloodGenerator",1,AAPTR_TRACER)
		TNT1 A 0 A_Explode(CallACS("BondHitBox", user_damage),4,0,false,4)
        TNT1 A 1 A_RearrangePointers(AAPTR_TRACER,AAPTR_NULL,AAPTR_NULL)
        stop
    }
}
Actor Goldeneye_Blood : Goldeneye_BulletImpact
{
	+PUFFGETSOWNER
	+NOBLOCKMAP
	+NOTELEPORT
	+ALLOWPARTICLES
	States
	{
		Spawn:
			TNT1 A 0
			TNT1 A 0 A_SpawnItemEx("Switchable_FlyingBlood",0,0,0,random(-350,350)/100.00,random(-350,350)/100.00,random(500,1000)/100.00,random(-180,180),33|SXF_TRANSFERPOINTERS)
			TNT1 A 0 A_Jump(256, "Spawn1", "Spawn2", "Spawn3", "Spawn4")
			Goto Spawn1
		Spawn1:
			GE00 FGHIJ 2
			stop
		Spawn2:
			GE01 FGHIJ 2
			stop
		Spawn3:
			GE02 FGHIJ 2
			stop
		Spawn4:
			GE03 FGHIJ 2
			stop
	}
}

Actor GE_BloodGenerator : CustomInventory
{
	+INVENTORY.ALWAYSPICKUP
	Inventory.PickupMessage ""
	Inventory.PickupSound ""
	States
	{
		Pickup:
			TNT1 A 0
			TNT1 A 0 A_CheckFlag("NOBLOOD",1)
			TNT1 A 0 A_SpawnItemEx("Goldeneye_Blood",(radius-16)*cos(CallACS("SamsaraBloodGeneratorReturn",1)),(radius-16)*sin(CallACS("SamsaraBloodGeneratorReturn",1)),CallACS("SamsaraBloodGeneratorReturn",2),0,0,0,0,SXF_NOCHECKPOSITION|SXF_USEBLOODCOLOR|SXF_ABSOLUTEPOSITION|SXF_ABSOLUTEVELOCITY)
			TNT1 A 0
			stop
	}
}

Actor Goldeneye_Cartridge_Standard
{
	Speed 2
	Mass 8
	Radius 2
	Height 2
	Scale 0.75
	+MISSILE
	+CLIENTSIDEONLY
	+THRUACTORS
	+DROPOFF
	+NOTELEPORT
	+FLOORCLIP
	+DONTSPLASH
	-SOLID
	States
	{
		Spawn:
			TNT1 A 0
			TNT1 A 0 A_SetPitch(pitch+frandom(-25,25))
			TNT1 A 0 A_SetAngle(angle+frandom(-10,10))
		SpawnLoop:
			GE00 A 0 A_SetAngle(angle+2.0)
			GE00 A 1 A_SetPitch(pitch+5.0)
			loop
		Death:
			TNT1 A 1 A_PlaySound("Goldeneye/Casing",CHAN_BODY)
			Stop
	}
}

//Apparently this appears too big for some guns, even if you change the offsets it's too small for others
Actor Goldeneye_Cartridge_Standard2 : Goldeneye_Cartridge_Standard { Scale 0.5}
Actor Goldeneye_Cartridge_Rifle : Goldeneye_Cartridge_Standard {}
Actor Goldeneye_Cartridge_Shell : Goldeneye_Cartridge_Standard {}

Actor Goldeneye_Cartridge_StandardSoundSource : Goldeneye_Cartridge_Standard
{
	States
	{
		Death:
			TNT1 A 1 A_PlaySound("GoldeneyeSource/Casing",CHAN_BODY)
			Stop
	}
}

Actor Goldeneye_Cartridge_StandardSoundSource2 : Goldeneye_Cartridge_StandardSoundSource { Scale 0.5 }

Actor Goldeneye_Cartridge_RifleSoundSource : Goldeneye_Cartridge_StandardSoundSource {}

Actor Goldeneye_Cartridge_ShellSoundSource : Goldeneye_Cartridge_StandardSoundSource
{
	States
	{
		Death:
			TNT1 A 1 A_PlaySound("GoldeneyeSource/ShellCasing",CHAN_BODY)
			Stop
	}
}

actor Goldeneye_BulletSmoke
{
	Projectile
	Radius 1
	Height 1
	Damage 0
	Speed 0
	Scale 0.16
	RenderStyle Translucent
	Alpha 0
	+NOBLOCKMAP
	+CLIENTSIDEONLY
	States
	{
		Spawn:
			GE08 A 0
			GE08 A 0 ACS_NamedExecuteAlways("BondSpriteEffects", 0, 1)
			GE08 A 0 A_ChangeVelocity(0, 0, 0.2, CVF_REPLACE)
			GE08 A 0 A_Jump(256, "Spawn1", "Spawn2", "Spawn3", "Spawn4")
			Goto Spawn1
		Spawn1:
			GE08 A 4
			Loop
		Spawn2:
			GE08 B 4
			Loop
		Spawn3:
			GE08 C 4
			Loop
		Spawn4:
			GE08 D 4
			Loop
	}
}

ACTOR Goldeneye_TimeFreezer : PowerupGiver
{
   	Inventory.MaxAmount 0
	Powerup.Duration 0x7FFFFFFD
	Powerup.Type TimeFreezer
	+INVENTORY.AUTOACTIVATE
	+INVENTORY.ALWAYSPICKUP
	States
	{
		Spawn:
			TNT1 A 2
			Loop
	}
}

Actor Goldeneye_WatchTabSwitch
{
	Radius 1
	Height 1
	+NOBLOCKMAP
	+NOINTERACTION
	+CLIENTSIDEONLY
	+NOTIMEFREEZE
	States
	{
		Spawn:
			TNT1 A 0
			TNT1 A 0 A_PlaySound("Goldeneye/WatchBeep", CHAN_NOPAUSE|CHAN_5, 0.5, false)
			stop
	}
}

Actor Goldeneye_WatchOpen
{
	Radius 1
	Height 1
	+NOBLOCKMAP
	+NOINTERACTION
	+CLIENTSIDEONLY
	+NOTIMEFREEZE
	States
	{
		Spawn:
			TNT1 A 0
			TNT1 A 0 A_PlaySound("Goldeneye/WatchOpen", CHAN_NOPAUSE|CHAN_5, 0.5, false)
			stop
	}
}

Actor Goldeneye_WatchClose
{
	Radius 1
	Height 1
	+NOBLOCKMAP
	+NOINTERACTION
	+CLIENTSIDEONLY
	+NOTIMEFREEZE
	States
	{
		Spawn:
			TNT1 A 0
			TNT1 A 0 A_PlaySound("Goldeneye/WatchClose", CHAN_NOPAUSE|CHAN_5, 0.5, false)
			stop
	}
}

ACTOR Goldeneye_ExplosionZThrust : CustomInventory
{
	+INVENTORY.ALWAYSPICKUP
	Inventory.PickupMessage ""
	Inventory.PickupSound ""
	States
	{
		Spawn:
			TNT1 A 0
			TNT1 A 1
			Stop
		Pickup:
			TNT1 A 0
			TNT1 A 1 A_JumpIf(health <= 20, "Thrust")
			stop
		Thrust:
			TNT1 A 1 ThrustThingZ(0,2000/mass,0,1)
			Stop
	}
}

Actor Goldeneye_WatchBlockRemover : Trigger
{
	States
	{
		Pickup:
			TNT1 A 0 A_ChangeFlag("NOBLOCKMONST",1)
			Stop
	}
}


